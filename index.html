<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detector Universal de Streams (PWA)</title>
  <meta name="theme-color" content="#020617" />
  <link rel="manifest" href="manifest.json" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen">
  <div class="max-w-5xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-2">ğŸ“¡ Detector Universal de Streams</h1>
    <p class="text-slate-400 mb-6">
      Icecast â€¢ Shoutcast â€¢ MP3 â€¢ AAC â€¢ MP4 â€¢ M3U8 â€¢ OGG â€¢ OPUS
    </p>

    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-slate-900 rounded-2xl p-5">
        <h2 class="text-xl font-semibold mb-3">ğŸ“„ Analizar HTML</h2>
        <textarea id="htmlInput" class="w-full h-40 p-3 rounded bg-slate-800 text-sm" placeholder="Pega aquÃ­ el cÃ³digo HTML de la radio"></textarea>
        <button onclick="extractFromHTML()" class="mt-3 px-4 py-2 bg-indigo-600 rounded">Analizar</button>
      </div>

      <div class="bg-slate-900 rounded-2xl p-5">
        <h2 class="text-xl font-semibold mb-3">ğŸ¯ Bookmarklet</h2>
        <p class="text-sm text-slate-400 mb-3">ArrÃ¡stralo a marcadores y ejecÃºtalo dentro de la web de la radio.</p>
        <a class="inline-block px-4 py-2 bg-emerald-500 text-black font-semibold rounded"
          href="javascript:(()=>{const u=new Set();document.querySelectorAll('audio,source').forEach(e=>e.src&&u.add(e.src));performance.getEntriesByType('resource').forEach(r=>{if(/icecast|shoutcast|\.mp3|\.aac|\.m3u8|\.ogg|\.opus|/i.test(r.name))u.add(r.name)});alert([...u].join('\n')||'No encontrado');})();">Detectar Streams</a>
      </div>
    </div>

    <div class="bg-slate-900 rounded-2xl p-5 mt-6">
      <h2 class="text-xl font-semibold mb-3">ğŸ“¥ Resultados</h2>
      <ul id="results" class="space-y-2 text-sm"></ul>
    </div>

    <div class="mt-6 text-xs text-slate-500">
      âš ï¸ Uso educativo. Algunos streams pueden requerir autorizaciÃ³n.
    </div>
  </div>

<script>
const STREAM_REGEX = /(https?:\/\/[^"'\s]+(icecast|shoutcast|\.mp3|\.aac|\.mp4|\.m3u8|\.ogg|\.opus))(\?[^"']*)?/gi;

function extractFromHTML(){
  const html=document.getElementById('htmlInput').value;
  const results=document.getElementById('results');
  results.innerHTML='';
  if(!html) return;

  const urls=new Set();
  const doc=new DOMParser().parseFromString(html,'text/html');

  doc.querySelectorAll('audio,source').forEach(e=>e.src&&urls.add(e.src));
  let m; while((m=STREAM_REGEX.exec(html))!==null) urls.add(m[0]);

  if(!urls.size){results.innerHTML='<li class="text-red-400">No se detectaron streams</li>';return;}

  urls.forEach(u=>{
    const li=document.createElement('li');
    li.innerHTML=`<a href="${u}" target="_blank" class="text-indigo-400 hover:underline">${u}</a>`;
    results.appendChild(li);
  });
}

if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>

<!-- Archivos extra necesarios:
manifest.json
sw.js
-->
